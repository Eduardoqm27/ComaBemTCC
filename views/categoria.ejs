<main>
    <!-- Gerenciamento de Produtos -->
    <section class="top-bar">
        <button id="btnAdicionar" class="btn-gerenciamento" aria-label="Adicionar Produto">
            Adicionar Produto
        </button>
    </section>

    <!-- Lista de Produtos -->
    <section class="product-list">
        <h2>Produtos Cadastrados</h2>
        <div class="product-container">
            <% if (produtos && produtos.length > 0) { %>
                <% produtos.forEach((produto) => { %>
                    <div class="product-card">
                        <img src="/img/<%= produto.imagem %>" alt="<%= produto.nome_produto %>" />
                        <div class="product-info">
                            <h3><%= produto.nome_produto %></h3>
                            <p>Preço: R$ <%= parseFloat(produto.preco).toFixed(2).replace('.', ',') %></p>
                        </div>
                        <div class="product-actions">
                            <form action="/produto/editar/<%= produto.id %>" method="GET">
                                <button class="btn btn-edit">Editar</button>
                            </form>
                            <form action="/carrinho/adicionar" method="POST">
                                <input type="hidden" name="produtoId" value="<%= produto.id %>">
                                <button class="btn btn-add-cart">Carrinho</button>
                            </form>
                        </div>
                    </div>
                <% }); %>
            <% } else { %>
                <p>Nenhum produto cadastrado ainda.</p>
            <% } %>
        </div>
    </section>

    <!-- Modal Adicionar Produto -->
    <section id="formModalAdicionar" class="modal" aria-hidden="true">
        <div class="modal-content">
            <button id="closeModalAdicionar" class="close" aria-label="Fechar Modal">&times;</button>
            <form
                action="/produto/adicionar"
                method="POST"
                enctype="multipart/form-data"
                class="form-tematico"
            >
                <h2>Adicionar Novo Produto</h2>
                <label for="nome">Nome do Produto:</label>
                <input type="text" name="nome_produto" id="nome" required />

                <label for="origem">Origem:</label>
                <input type="text" name="origem" id="origem" required />

                <label for="marca">Marca:</label>
                <input type="text" name="marca" id="marca" required />

                <label for="descricao">Descrição:</label>
                <textarea name="descricao" id="descricao" required></textarea>

                <label for="preco">Preço (R$):</label>
                <input type="number" name="preco" id="preco" step="0.01" required />

                <label for="foto">Foto:</label>
                <input type="file" name="imagem" id="foto" accept="image/*" required />

                <label for="desconto">Desconto (%):</label>
                <input type="number" name="promocao" id="desconto" min="0" max="100" />

                <label for="destaque">Destaque:</label>
                <input type="checkbox" name="destaque" id="destaque" />

                <label for="categoria">Categoria:</label>
                <select name="categoria" id="categoria" required>
                    <option value="Fruta">Fruta</option>
                    <option value="Legume">Legume</option>
                    <option value="Verdura">Verdura</option>
                    <option value="Kits">Kits</option>
                </select>

                <button type="submit">Adicionar Produto</button>
            </form>
        </div>
    </section>
</main>

<script>
    const btnAdicionar = document.getElementById('btnAdicionar');
    const modalAdicionar = document.getElementById('formModalAdicionar');
    const closeModalAdicionar = document.getElementById('closeModalAdicionar');

    btnAdicionar.addEventListener('click', () => {
        modalAdicionar.setAttribute('aria-hidden', 'false');
        modalAdicionar.style.display = 'block';
    });

    closeModalAdicionar.addEventListener('click', () => {
        modalAdicionar.setAttribute('aria-hidden', 'true');
        modalAdicionar.style.display = 'none';
    });

    window.addEventListener('click', (event) => {
        if (event.target === modalAdicionar) {
            modalAdicionar.setAttribute('aria-hidden', 'true');
            modalAdicionar.style.display = 'none';
        }
    });
</script>

<style>
    .product-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: center;
    }

    .product-card {
        border: 1px solid #ccc;
        border-radius: 10px;
        padding: 10px;
        width: 200px;
        text-align: center;
        background-color: #f9f9f9;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .product-card img {
        width: 100%;
        height: auto;
        border-radius: 10px;
    }

    .product-info {
        margin-top: 10px;
    }

    .product-actions {
        display: flex;
        justify-content: space-between;
        margin-top: 10px;
    }

    .btn {
        padding: 5px 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 15px;
    }

    .btn-edit {
        background-color: #ffc107;
        color: #fff;
    }

    .btn-add-cart {
        background-color: #28a745;
        color: #fff;
    }
</style>